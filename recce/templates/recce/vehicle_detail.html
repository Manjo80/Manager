{% extends "base.html" %}
{% block title %}{{ vehicle }}{% endblock %}
{% block content %}
<div class="d-flex align-items-center justify-content-between mb-3">
  <div>
    <div class="text-muted small">Fahrzeug</div>
    <h1 class="h4 m-0">{{ vehicle.brand }} {{ vehicle.model }}{% if vehicle.variant %} – {{ vehicle.variant }}{% endif %}</h1>
    <div class="text-muted small">{% if vehicle.year_from or vehicle.year_to %}{{ vehicle.year_from|default:"" }}–{{ vehicle.year_to|default:"" }}{% endif %}</div>
  </div>
  <div class="d-flex gap-2">
    <a class="btn btn-outline-secondary btn-sm" href="{% url 'recce:vehicle_filter' %}">Zurück</a>
    <a class="btn btn-outline-primary btn-sm" href="{% url 'recce:vehicle_edit' vehicle.pk %}">Bearbeiten</a>
  </div>
</div>

{% if vehicle.description %}
  <div class="card card-body mb-3">{{ vehicle.description|linebreaksbr }}</div>
{% endif %}

<div class="d-flex align-items-center justify-content-between mb-2">
  <div class="fw-semibold">Fotos</div>
  <a class="btn btn-sm btn-primary" href="{% url 'recce:vehicle_photo_new' vehicle.pk %}">Foto hinzufügen</a>
</div>

<div class="row g-2 mb-3">
  {% for p in vehicle.photos.all %}
    <div class="col-12 col-md-4">
      <div class="card">
        <img class="img-thumb" src="{{ p.image.url }}" alt="" data-enlarge="1" style="cursor:zoom-in;">
        <div class="card-body py-2">
          <div class="small text-muted">{% if p.perspective %}{{ p.perspective.label }}{% else %}Foto{% endif %}</div>
          <div class="small">{{ p.caption|default:"" }}</div>
          <div class="mt-2 d-flex gap-2">
            <a class="btn btn-outline-danger btn-sm" href="{% url 'recce:vehicle_photo_delete' p.pk %}">Löschen</a>
          </div>
        </div>
      </div>
    </div>
  {% empty %}
    <div class="text-muted">Keine Fotos.</div>
  {% endfor %}
</div>

<div class="d-flex align-items-center justify-content-between mb-2">
  <div class="fw-semibold">Einbaumöglichkeiten</div>
  <a class="btn btn-sm btn-primary" href="{% url 'recce:install_new' vehicle.pk %}">Neu</a>
</div>

<div class="list-group">
  {% for i in vehicle.install_options.all %}
    <a class="list-group-item list-group-item-action" href="{% url 'recce:install_detail' i.pk %}">
      <div class="d-flex justify-content-between">
        <div>
          <div class="fw-semibold">{{ i.title }}</div>
          <div class="text-muted small">
            {% if i.risk_level %}Risiko: {{ i.risk_level.label }} • {% endif %}
            {% if i.effort_minutes %}Zeit: {{ i.effort_minutes }} min • {% endif %}
            Fotos: {{ i.photos.count }}
          </div>
        </div>
        <span class="text-muted small">›</span>
      </div>
    </a>
  {% empty %}
    <div class="text-muted">Keine Einbaumöglichkeiten.</div>
  {% endfor %}
</div>

{% endblock %}
